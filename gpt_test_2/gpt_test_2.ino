#include <ezButton.h>
#include <Wire.h> 
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
#include <Fonts/FreeSerif12pt7b.h>

#define SCREEN_I2C_ADDR 0x3C
#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define OLED_RST_PIN -1

Adafruit_SSD1306 oled = Adafruit_SSD1306(128, 64, &Wire, OLED_RST_PIN);

//-----------PINS------------
//#define ENA_PIN 7  // The Arduino pin connected to the EN1 pin L298N
#define IN1_PIN 6  // The Arduino pin connected to the IN1 pin L298N
#define IN2_PIN 5  // The Arduino pin connected to the IN2 pin L298N

int rainsense = A0;
int ldr = 4;
int buzzerout = 10; 
int ledout= 11;

ezButton limitSwitch_1(A1);  // create ezButton object that attach to pin A0
ezButton limitSwitch_2(A2);  // create ezButton object that attach to pin A1

//---------------------------------

#define FRAME_DELAY (42)
#define FRAME_WIDTH (32)
#define FRAME_HEIGHT (32)

const byte PROGMEM frame1[][128] = {
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,4,0,0,131,12,0,1,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,4,0,0,128,12,0,1,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,4,0,0,128,12,0,1,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,4,0,0,128,12,0,1,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,128,12,0,1,0,8,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,12,0,1,0,8,0,0,8,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,8,0,0,8,0,0,0,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,8,0,0,0,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,4,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,24,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,16,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,32,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,32,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,0,8,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,0,8,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,0,0,0,131,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,0,0,0,131,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,4,0,0,131,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,31,192,0,0,96,32,0,0,64,16,0,0,192,24,0,0,128,15,192,0,128,8,96,1,128,0,16,15,128,0,24,8,0,0,8,16,0,0,8,16,0,0,8,16,0,0,8,16,0,0,24,16,0,0,16,8,0,0,32,7,255,255,192,0,255,254,0,0,0,0,0,0,1,4,0,0,131,12,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
};

#define FRAME_DELAY (42)
#define FRAME_WIDTH (32)
#define FRAME_HEIGHT (32)

const byte PROGMEM frame2[][128] = {
  {0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,1,128,0,0,1,128,0,0,1,128,0,1,0,0,128,0,128,1,0,0,64,2,0,0,7,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,0,30,32,4,120,30,32,4,120,0,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,224,0,0,64,2,0,0,128,1,0,1,0,0,128,0,1,128,0,0,1,128,0,0,1,128,0,0,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,128,0,0,0,128,0,1,0,128,0,1,128,0,192,0,192,1,128,0,64,3,0,0,7,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,0,30,32,4,0,0,32,4,120,0,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,224,0,0,192,2,0,1,128,3,0,3,0,1,128,0,1,0,128,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,128,0,0,0,128,0,1,0,128,0,0,128,0,64,0,192,1,128,0,64,3,0,0,7,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,0,30,32,4,0,0,32,4,120,0,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,224,0,0,192,2,0,1,128,2,0,2,0,1,0,0,1,0,128,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,192,0,0,0,192,0,1,128,128,0,0,192,0,64,0,64,0,192,0,0,1,128,0,7,225,0,0,28,56,0,0,16,8,0,0,48,12,0,28,32,4,0,30,32,4,0,0,32,4,112,0,32,4,56,0,48,12,0,0,16,8,0,0,28,56,0,0,7,224,0,1,128,0,0,3,0,2,0,2,0,3,0,0,1,1,128,0,3,0,0,0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,64,0,0,0,64,0,0,128,192,0,0,192,0,0,0,96,0,192,0,0,1,128,0,7,225,0,0,28,56,0,0,16,8,0,0,48,12,0,30,32,4,0,6,32,4,0,0,32,4,32,0,32,4,120,0,48,12,0,0,16,8,0,0,28,56,0,0,135,224,0,1,128,0,0,3,0,6,0,0,0,3,0,0,3,1,0,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,64,0,0,0,64,0,0,192,64,0,0,64,0,0,0,32,0,64,0,0,0,192,0,7,225,0,0,28,56,0,0,16,8,0,0,48,12,0,30,32,4,0,0,32,4,0,0,32,4,0,0,32,4,120,0,48,12,0,0,16,8,0,0,28,56,0,0,135,224,0,3,0,0,0,2,0,4,0,0,0,2,0,0,2,3,0,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,0,64,0,0,192,64,0,0,96,0,0,0,32,0,0,0,0,0,192,0,7,225,128,0,28,56,0,0,16,8,0,8,48,12,0,14,32,4,0,0,32,4,0,0,32,4,0,0,32,4,112,0,48,12,16,0,16,8,0,0,28,56,0,1,135,224,0,3,0,0,0,0,0,4,0,0,0,6,0,0,2,2,0,0,2,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,64,96,0,0,64,64,0,0,32,0,0,0,0,0,0,0,0,0,64,0,7,224,128,0,28,56,0,0,16,8,0,12,48,12,0,6,32,4,0,0,32,4,0,0,32,4,0,0,32,4,96,0,48,12,48,0,16,8,0,0,28,56,0,1,7,224,0,2,0,0,0,0,0,0,0,0,0,4,0,0,2,2,0,0,6,2,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,64,32,0,0,96,32,0,0,32,0,0,0,0,0,0,0,0,0,96,0,7,224,192,0,28,56,0,0,16,8,0,14,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,112,0,16,8,0,0,28,56,0,3,7,224,0,6,0,0,0,0,0,0,0,0,0,4,0,0,4,6,0,0,4,2,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,0,32,0,0,32,32,0,0,32,0,0,0,0,0,0,0,0,0,0,0,7,224,192,0,28,56,0,0,16,8,0,14,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,112,0,16,8,0,0,28,56,0,3,7,224,0,0,0,0,0,0,0,0,0,0,0,12,0,0,4,4,0,0,4,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,32,48,0,0,32,32,0,0,16,0,0,0,0,0,0,0,0,0,0,0,7,224,96,0,28,56,128,12,16,8,0,6,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,96,0,16,8,48,1,28,56,0,6,7,224,0,0,0,0,0,0,0,0,0,0,0,8,0,0,4,4,0,0,12,4,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,32,16,0,0,48,16,0,0,16,0,0,0,0,0,0,0,0,0,0,0,7,224,96,0,28,56,192,14,16,8,0,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,0,0,16,8,112,2,28,56,0,6,7,224,0,0,0,0,0,0,0,0,0,0,0,8,0,0,8,12,0,0,8,4,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,48,16,0,0,16,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,32,0,28,56,96,6,16,8,0,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,0,0,16,8,96,6,28,56,0,4,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,0,0,8,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,24,0,0,16,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,0,4,28,56,96,6,16,8,0,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,0,0,16,8,96,6,28,56,32,0,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,0,0,24,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,8,0,0,16,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,0,6,28,56,96,0,16,8,64,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,0,0,16,8,0,6,28,56,96,0,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,24,0,0,16,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,8,0,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,224,0,6,28,56,32,0,16,8,96,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,0,6,16,8,0,4,28,56,96,0,7,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,16,0,0,16,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,12,0,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,4,7,224,0,6,28,56,0,0,16,8,96,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,0,6,16,8,0,0,28,56,96,0,7,224,32,0,0,0,0,0,0,0,0,0,0,0,0,0,16,16,0,0,48,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,8,4,0,0,8,12,0,0,0,8,0,0,0,0,0,0,0,0,0,6,7,224,0,3,28,56,0,0,16,8,112,0,48,12,0,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,0,48,12,0,14,16,8,0,0,28,56,64,0,7,224,96,0,0,0,0,0,0,0,0,0,16,0,0,0,48,16,0,0,32,16,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,12,4,0,0,4,4,0,0,0,8,0,0,0,0,0,0,0,0,0,6,7,224,0,1,28,56,0,0,16,8,48,0,48,12,96,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,6,48,12,0,12,16,8,0,0,28,56,128,0,7,224,96,0,0,0,0,0,0,0,0,0,16,0,0,0,32,32,0,0,32,48,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,4,0,0,0,4,4,0,0,0,4,0,0,0,0,0,0,0,0,0,3,7,224,0,0,28,56,0,0,16,8,0,0,48,12,112,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,14,48,12,0,0,16,8,0,0,28,56,0,0,7,224,192,0,0,0,0,0,0,0,0,0,32,0,0,0,32,32,0,0,0,32,0,0,0,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,4,2,0,0,4,6,0,0,0,4,0,0,0,0,0,6,0,0,0,3,7,224,0,0,28,56,0,0,16,8,0,0,48,12,112,0,32,4,0,0,32,4,0,0,32,4,0,0,32,4,0,14,48,12,0,0,16,8,0,0,28,56,0,0,7,224,192,0,0,0,96,0,0,0,0,0,32,0,0,0,96,32,0,0,64,32,0,0,0,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,6,2,0,0,6,2,0,0,0,4,0,0,0,0,0,2,0,0,0,1,7,224,0,0,28,56,0,0,16,8,0,0,48,12,48,0,32,4,96,0,32,4,0,0,32,4,0,6,32,4,0,12,48,12,0,0,16,8,0,0,28,56,0,0,7,224,128,0,0,0,64,0,0,0,0,0,32,0,0,0,64,64,0,0,64,96,0,0,0,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,2,0,0,0,2,2,0,0,0,6,0,0,0,4,0,3,0,0,0,1,135,224,0,0,28,56,0,0,16,8,0,0,48,12,16,0,32,4,112,0,32,4,0,0,32,4,0,14,32,4,0,8,48,12,0,0,16,8,0,0,28,56,0,0,7,225,128,0,0,0,192,0,32,0,0,0,96,0,0,0,64,64,0,0,0,64,0,0,0,96,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,3,0,0,0,2,0,2,0,4,0,3,0,0,0,0,135,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,120,0,32,4,0,0,32,4,0,30,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,225,0,0,0,0,192,0,32,0,64,0,64,0,0,0,192,64,0,0,0,64,0,0,0,64,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,1,0,0,0,3,0,3,0,6,0,1,128,0,0,0,135,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,120,0,32,4,96,4,32,4,0,30,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,225,0,0,0,1,128,0,96,0,192,0,192,0,0,0,128,192,0,0,0,64,0,0,0,64,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,1,1,128,2,0,3,0,3,0,2,0,1,128,0,0,0,135,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,56,0,32,4,120,14,32,4,0,28,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,224,0,0,0,1,128,0,64,0,192,0,192,0,64,1,128,128,0,0,0,192,0,0,0,192,0,0,0,192,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,128,2,0,1,0,1,128,2,0,0,192,2,0,0,7,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,0,0,32,4,120,30,32,4,0,0,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,224,0,0,64,3,0,0,192,1,128,0,128,0,64,1,0,128,0,0,0,128,0,0,0,128,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,128,3,0,1,128,1,128,3,0,0,192,2,0,0,7,224,0,0,28,56,0,0,16,8,0,0,48,12,0,0,32,4,0,0,32,4,120,30,32,4,0,0,32,4,0,0,48,12,0,0,16,8,0,0,28,56,0,0,7,224,0,0,64,3,0,0,192,1,128,1,128,0,192,1,0,128,0,0,0,128,0,0,0,128,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0}
};
const byte* const frames[] PROGMEM = { frame1[0], frame2[0] };
const int numFrames = sizeof(frames) / sizeof(frames[0]);

void setup() {
  Serial.begin(9600);

  //----------Pin Modes----------
  pinMode(rainsense, INPUT);
  pinMode(ldr, INPUT);
  pinMode(buzzerout, OUTPUT);
  pinMode(ledout, OUTPUT);
  //motor driver controls
  // pinMode(ENA_PIN, OUTPUT);
   pinMode(IN1_PIN, OUTPUT);
   pinMode(IN2_PIN, OUTPUT);

 //--------------------

  limitSwitch_1.setDebounceTime(50);  // set debounce time to 50 milliseconds
  limitSwitch_2.setDebounceTime(50);  // set debounce time to 50 milliseconds

  oled.begin(SSD1306_SWITCHCAPVCC, SCREEN_I2C_ADDR);
}

void loop() {
  limitSwitch_1.loop();  // MUST call the loop() function first
  limitSwitch_2.loop();  // MUST call the loop() function first
  
  oled.clearDisplay();
  oled.setTextColor(WHITE);

  int rainSenseReading = analogRead(rainsense);
  Serial.print("Rain Sense Reading = ");
  Serial.println(rainSenseReading);

  int ldrStatus = digitalRead(ldr);
  Serial.print("LDR Status= ");
  Serial.println(ldrStatus);
  


  if (rainSenseReading < 450  && ldrStatus == LOW) {
    oled.setTextSize(2);
    oled.setCursor(0, 0);
    oled.print("Weather: ");
    oled.setTextSize(2);
    /*oled.clearDisplay();*/
    oled.drawBitmap(0, 25, frame1[0],FRAME_WIDTH, FRAME_HEIGHT, WHITE);
    oled.setCursor(40, 30);
    oled.print("Rain!");
    oled.display();
    delay(1000);
    runMotorBackward(); 
  }
  
  else if (rainSenseReading >= 450 && ldrStatus == HIGH ) {
    oled.setTextSize(2);
    oled.setCursor(0, 0);
    oled.print("Weather: ");
    oled.setTextSize(2);
    /*oled.clearDisplay();*/
    oled.drawBitmap(0, 25, frame2[0],FRAME_WIDTH, FRAME_HEIGHT, WHITE);
    oled.setCursor(40, 30);
    oled.print("Sunny!");
    oled.display();
    delay(1000);
    runMotorForward();    
  }

  
  if (limitSwitch_1.isPressed()) {
    Serial.println(F("Limit switch 1 pressed. Stopping motor."));
    stopMotor();
  }

  if (limitSwitch_2.isPressed()) {
    Serial.println(F("Limit switch 2 pressed. Stopping motor."));
    stopMotor();
  }
}

void stopMotor() {
  digitalWrite(IN1_PIN, LOW);
  digitalWrite(IN2_PIN, LOW);
}

// Function to run the motor forward
void runMotorForward() {
  //digitalWrite(ENA_PIN, HIGH);  // max speed
  digitalWrite(IN1_PIN, HIGH);;
  digitalWrite(IN2_PIN, LOW);
  Serial.println("Motor running forward.");
}

// Function to run the motor backward
void runMotorBackward() {
  //digitalWrite(ENA_PIN, HIGH);  // max speed
  digitalWrite(IN1_PIN, LOW);
  digitalWrite(IN2_PIN, HIGH);
  Serial.println("Motor running backward.");
}
